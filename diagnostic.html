<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Diagnostic Test | BloomELearning âœ¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<header>
  <div class="container">
    <div class="logo">BloomELearning âœ¨</div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="phonics.html">Phonics</a></li>
        <li><a href="reading.html">Reading</a></li>
        <li><a href="math.html">Math</a></li>
        <li><a href="diagnostic.html">Diagnostic</a></li>
      </ul>
    </nav>
  </div>
</header>

<section class="hero">
  <div class="container">
    <h1>ðŸ§  Diagnostic Test</h1>
    <p>For 2nd grade and older. Quick skill check with recommendations.</p>
  </div>
</section>

<section class="section">
  <div class="container">
    <h2 class="section-title">Start Diagnostic</h2>

    <div class="game-box">

      <div style="font-weight:900;">Choose level:</div>
      <div class="grade-row">
        <button class="select" data-level="2-3">2ndâ€“3rd Grade</button>
        <button class="select" data-level="4plus">4th Grade+</button>
      </div>

      <div id="quiz" style="margin-top:20px;"></div>

      <div class="game-row">
        <button class="btn secondary" id="readAloudBtn" disabled>ðŸ”Š Read Question</button>
        <button class="btn secondary" id="prevBtn" disabled>â¬… Prev</button>
        <button class="btn secondary" id="nextBtn" disabled>Next âž¡</button>
      </div>

      <div class="game-row">
        <button class="btn" id="submitBtn" disabled>Submit Diagnostic</button>
        <button class="btn secondary" id="resetBtn" disabled>Reset</button>
        <a class="btn secondary" href="index.html">Back Home</a>
      </div>

      <div id="results" style="margin-top:20px;"></div>

    </div>
  </div>
</section>

<footer>
  Â© 2026 BloomELearning âœ¨ | Made with ðŸ’–
</footer>

<script>
/* ---------------- Question Banks ---------------- */

const bank_2_3 = [
  { domain:"Word Skills", q:"Which word has a long A sound?", options:["rain","ran","ring"], correct:0 },
  { domain:"Word Skills", q:"Which word has an r-controlled vowel?", options:["car","cake","cap"], correct:0 },
  { domain:"Reading", q:"Read: 'Sam packed a lunch for a field trip.' Why did Sam pack lunch?", options:["Field trip","Bedtime","Dinner party"], correct:0 },
  { domain:"Reading", q:"Read: 'The dog ran to the door when it heard the bell.' What made it run?", options:["A bell","A cat","A sandwich"], correct:0 },
  { domain:"Math", q:"47 + 18 = ?", options:["65","55","75"], correct:0 },
  { domain:"Math", q:"56 - 29 = ?", options:["27","37","25"], correct:0 }
];

const bank_4plus = [
  { domain:"Word Skills", q:"Which word has a prefix meaning 'again'?", options:["redo","happy","played"], correct:0 },
  { domain:"Word Skills", q:"Which word contains a silent letter?", options:["knight","kite","kit"], correct:0 },
  { domain:"Reading", q:"Read: 'Ella forgot her homework, so she wrote it in her planner.' What lesson did she learn?", options:["Use a planner","Skip homework","Lose papers"], correct:0 },
  { domain:"Reading", q:"Read: 'Tom trained for weeks and improved.' What caused improvement?", options:["Training","A hat","Skipping practice"], correct:0 },
  { domain:"Math", q:"326 + 187 = ?", options:["513","413","503"], correct:0 },
  { domain:"Math", q:"72 Ã· 8 = ?", options:["9","8","7"], correct:0 }
];

/* ---------------- State ---------------- */

let level = null;
let questions = [];
let currentIndex = 0;
let answers = {};

/* ---------------- Elements ---------------- */

const quizEl = document.getElementById("quiz");
const resultsEl = document.getElementById("results");
const readBtn = document.getElementById("readAloudBtn");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const submitBtn = document.getElementById("submitBtn");
const resetBtn = document.getElementById("resetBtn");

/* ---------------- Speech ---------------- */

function speak(text) {
  if (!("speechSynthesis" in window)) {
    alert("Your browser does not support read aloud.");
    return;
  }
  window.speechSynthesis.cancel();
  const utter = new SpeechSynthesisUtterance(text);
  utter.rate = 1;
  window.speechSynthesis.speak(utter);
}

readBtn.addEventListener("click", () => {
  if (!questions.length) return;
  speak(questions[currentIndex].q);
});

/* ---------------- Rendering ---------------- */

function renderQuestion() {
  const q = questions[currentIndex];

  quizEl.innerHTML = `
    <div style="font-weight:900; margin-bottom:10px;">
      ${q.domain} â€¢ Question ${currentIndex+1} of ${questions.length}
    </div>
    <div style="font-size:20px; font-weight:900; margin-bottom:14px;">
      ${q.q}
    </div>
    <div class="game-row" id="optionsRow"></div>
  `;

  const optionsRow = document.getElementById("optionsRow");

  q.options.forEach((opt, idx) => {
    const btn = document.createElement("button");
    btn.className = "pill";
    btn.textContent = opt;

    if (answers[currentIndex] === idx) {
      btn.style.background = "rgba(247,213,215,0.4)";
    }

    btn.onclick = () => {
      answers[currentIndex] = idx;
      renderQuestion();
      updateButtons();
    };

    optionsRow.appendChild(btn);
  });

  updateButtons();
}

function updateButtons() {
  prevBtn.disabled = currentIndex === 0;
  nextBtn.disabled = currentIndex === questions.length-1;
  submitBtn.disabled = Object.keys(answers).length !== questions.length;
}

/* ---------------- Navigation ---------------- */

prevBtn.onclick = () => {
  if (currentIndex > 0) currentIndex--;
  renderQuestion();
};

nextBtn.onclick = () => {
  if (currentIndex < questions.length-1) currentIndex++;
  renderQuestion();
};

/* ---------------- Scoring ---------------- */

submitBtn.onclick = () => {
  let correct = 0;
  let domainTotals = {};
  let domainCorrect = {};

  questions.forEach((q,i)=>{
    domainTotals[q.domain] = (domainTotals[q.domain]||0)+1;
    domainCorrect[q.domain] = domainCorrect[q.domain]||0;

    if (answers[i] === q.correct) {
      correct++;
      domainCorrect[q.domain]++;
    }
  });

  const percent = Math.round((correct/questions.length)*100);

  let summary = `<div class="status">
    Score: ${correct} / ${questions.length} (${percent}%)
  </div><br>`;

  Object.keys(domainTotals).forEach(d=>{
    const pct = Math.round((domainCorrect[d]/domainTotals[d])*100);
    summary += `â€¢ ${d}: ${pct}%<br>`;
  });

  resultsEl.innerHTML = summary;
};

/* ---------------- Reset ---------------- */

resetBtn.onclick = () => {
  answers = {};
  currentIndex = 0;
  resultsEl.innerHTML = "";
  renderQuestion();
};

/* ---------------- Start ---------------- */

document.querySelectorAll(".select").forEach(btn=>{
  btn.onclick = ()=>{
    level = btn.getAttribute("data-level");
    questions = level==="2-3"? bank_2_3 : bank_4plus;
    answers = {};
    currentIndex = 0;

    readBtn.disabled = false;
    prevBtn.disabled = false;
    nextBtn.disabled = false;
    resetBtn.disabled = false;

    renderQuestion();
  };
});
</script>

</body>
</html>
