<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Progress | BloomELearning âœ¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>

<header>
  <div class="container">
    <div class="logo">BloomELearning âœ¨</div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>

        <li class="dropdown">
          <a href="#">Subjects</a>
          <div class="dropdown-menu">
            <a href="phonics.html">ğŸ”¤ Phonics</a>
            <a href="reading.html">ğŸ“– Reading</a>
            <a href="math.html">â• Math</a>
            <a href="letter-formation.html">âœï¸ Letter Tracing</a>
          </div>
        </li>

        <li class="dropdown">
          <a href="#">Resources</a>
          <div class="dropdown-menu">
            <a href="resources.html">ğŸ¥ Kids Resources</a>
            <a href="parent-resources.html">ğŸ§‘â€ğŸ« Parent Resources</a>
            <a href="standards.html">ğŸ“˜ Standards (Kâ€“2)</a>
          </div>
        </li>

        <li class="dropdown">
          <a href="#">Student</a>
          <div class="dropdown-menu">
            <a href="student-login.html">ğŸ§’ Student Login</a>
            <a href="progress.html">ğŸ“Š My Progress</a>
            <a href="sticker-book.html">ğŸ“– Sticker Book</a>
          </div>
        </li>

        <li><a href="games.html">ğŸ® Games</a></li>
        <li><a href="diagnostic.html">ğŸ§  Diagnostic</a></li>
      </ul>
    </nav>
  </div>
</header>

<section class="hero">
  <div class="container">
    <h1>My Progress ğŸ“Š</h1>
    <p id="welcomeLine">Loading studentâ€¦</p>
    <div class="quick-strip">
      <a class="btn secondary" href="sticker-book.html">ğŸ“– Sticker Book</a>
      <button class="btn secondary" id="logoutBtn">ğŸšª Logout</button>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <h2 class="section-title">Stars â­</h2>

    <div class="grid-3">
      <div class="card">
        <h3>ğŸ”¤ Phonics Stars</h3>
        <p class="kid-big" id="pStars">0</p>
        <button class="btn secondary" id="resetPhonics">Reset</button>
      </div>

      <div class="card">
        <h3>ğŸ“– Reading Stars</h3>
        <p class="kid-big" id="rStars">0</p>
        <button class="btn secondary" id="resetReading">Reset</button>
      </div>

      <div class="card">
        <h3>â• Math Stars</h3>
        <p class="kid-big" id="mStars">0</p>
        <button class="btn secondary" id="resetMath">Reset</button>
      </div>
    </div>

    <div class="game-box wide" style="margin-top:16px;">
      <h2 class="section-title">Todayâ€™s Mission ğŸŒŸ</h2>

      <div class="mission">
        <div>
          <div class="mission-item">
            <div class="left">
              <div class="chk" id="m1chk">âœ“</div>
              <div>Answer 2 phonics questions</div>
            </div>
            <div class="small" id="m1txt">0 / 2</div>
          </div>

          <div class="mission-item">
            <div class="left">
              <div class="chk" id="m2chk">âœ“</div>
              <div>Read 1 passage</div>
            </div>
            <div class="small" id="m2txt">0 / 1</div>
          </div>

          <div class="mission-item">
            <div class="left">
              <div class="chk" id="m3chk">âœ“</div>
              <div>Solve 2 math questions</div>
            </div>
            <div class="small" id="m3txt">0 / 2</div>
          </div>

          <div class="small" style="margin-top:10px;">Mission Progress</div>
          <div class="progressbar"><div id="missionBar"></div></div>
          <div class="small" id="missionPct" style="margin-top:6px;">0% complete</div>
        </div>

        <div>
          <div class="helper">
            <div class="face" id="helperFace">ğŸ¦„</div>
            <div>
              <div class="title" id="helperTitle">Unicorn Coach</div>
              <div class="msg" id="helperMsg">Earn stars and unlock stickers!</div>
            </div>
          </div>

          <div class="game-box" style="margin-top:12px;">
            <div class="kid-big">Unlocked Rewards ğŸ</div>
            <p class="small">Sticker packs unlock when you earn enough stars.</p>

            <div class="badges" style="margin-top:12px;">
              <div class="badge-tile" id="bMath">
                <div class="top">
                  <div class="icon">â•</div>
                  <div class="name">Math Sticker Pack</div>
                </div>
                <div class="req" id="bMathReq"></div>
              </div>

              <div class="badge-tile" id="bRead">
                <div class="top">
                  <div class="icon">ğŸ“–</div>
                  <div class="name">Reading Sticker Pack</div>
                </div>
                <div class="req" id="bReadReq"></div>
              </div>

              <div class="badge-tile" id="bPhonics">
                <div class="top">
                  <div class="icon">ğŸ”¤</div>
                  <div class="name">Phonics Sticker Pack</div>
                </div>
                <div class="req" id="bPhonicsReq"></div>
              </div>
            </div>

            <div class="quick-strip" style="margin-top:12px;">
              <a class="btn" href="sticker-book.html">Open Sticker Book</a>
              <a class="btn secondary" href="index.html">Back Home</a>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>
</section>

<footer>Â© 2026 BloomELearning âœ¨ | Made with ğŸ’š</footer>

<script>
  const STUDENT_KEY = "bloom_student";
  const PROG_KEY = "bloom_progress";
  const MISSION_KEY = "bloom_daily_mission";

  function load(key, fallback){
    try { return JSON.parse(localStorage.getItem(key) || JSON.stringify(fallback)); }
    catch { return fallback; }
  }
  function save(key, obj){ localStorage.setItem(key, JSON.stringify(obj)); }

  function todayKey(){
    const d = new Date();
    const y = d.getFullYear();
    const m = String(d.getMonth()+1).padStart(2,"0");
    const day = String(d.getDate()).padStart(2,"0");
    return `${y}-${m}-${day}`;
  }

  function ensureMission(){
    const t = todayKey();
    let ms = load(MISSION_KEY, null);
    if (!ms || ms.date !== t){
      ms = { date: t, phonics:0, reading:0, math:0 };
      save(MISSION_KEY, ms);
    }
    return ms;
  }

  // Gate: require "student login"
  const student = load(STUDENT_KEY, null);
  if (!student || !student.name){
    window.location.href = "student-login.html";
  } else {
    document.getElementById("welcomeLine").textContent = `Welcome, ${student.buddy || "ğŸ¦„"} ${student.name}!`;
  }

  function getProgress(){
    return load(PROG_KEY, { phonicsStars:0, readingStars:0, mathStars:0, tracingDone:0, gamesStars:0, diagnosticScore:null });
  }

  function renderStars(){
    const p = getProgress();
    document.getElementById("pStars").textContent = p.phonicsStars || 0;
    document.getElementById("rStars").textContent = p.readingStars || 0;
    document.getElementById("mStars").textContent = p.mathStars || 0;
  }

  function renderMission(){
    const ms = ensureMission();
    const g1=2, g2=1, g3=2;

    document.getElementById("m1txt").textContent = `${Math.min(ms.phonics,g1)} / ${g1}`;
    document.getElementById("m2txt").textContent = `${Math.min(ms.reading,g2)} / ${g2}`;
    document.getElementById("m3txt").textContent = `${Math.min(ms.math,g3)} / ${g3}`;

    const done1 = ms.phonics >= g1;
    const done2 = ms.reading >= g2;
    const done3 = ms.math >= g3;

    document.getElementById("m1chk").classList.toggle("done", done1);
    document.getElementById("m2chk").classList.toggle("done", done2);
    document.getElementById("m3chk").classList.toggle("done", done3);

    const pct = Math.round(((done1?1:0)+(done2?1:0)+(done3?1:0))/3 * 100);
    document.getElementById("missionBar").style.width = pct + "%";
    document.getElementById("missionPct").textContent = `${pct}% complete`;

    const face = document.getElementById("helperFace");
    const title = document.getElementById("helperTitle");
    const msg = document.getElementById("helperMsg");

    if (pct === 100){
      face.textContent = "ğŸ‰";
      title.textContent = "Mission Complete!";
      msg.textContent = "Woohoo! You finished todayâ€™s mission!";
    } else if (pct >= 34){
      face.textContent = "ğŸ¦‰";
      title.textContent = "Owl Helper";
      msg.textContent = "Great job! Keep going!";
    } else {
      face.textContent = "ğŸ¦„";
      title.textContent = "Unicorn Coach";
      msg.textContent = "Letâ€™s start learning and earn stars!";
    }
  }

  function renderBadges(){
    const p = getProgress();

    const mathUnlocked = (p.mathStars || 0) >= 10;
    const readUnlocked = (p.readingStars || 0) >= 5;
    const phonicsUnlocked = (p.phonicsStars || 0) >= 10;

    const bMath = document.getElementById("bMath");
    const bRead = document.getElementById("bRead");
    const bPhon = document.getElementById("bPhonics");

    bMath.classList.toggle("locked", !mathUnlocked);
    bRead.classList.toggle("locked", !readUnlocked);
    bPhon.classList.toggle("locked", !phonicsUnlocked);

    document.getElementById("bMathReq").textContent = mathUnlocked ? "Unlocked âœ…" : `Unlock at 10 Math â­ (you have ${p.mathStars||0})`;
    document.getElementById("bReadReq").textContent = readUnlocked ? "Unlocked âœ…" : `Unlock at 5 Reading â­ (you have ${p.readingStars||0})`;
    document.getElementById("bPhonicsReq").textContent = phonicsUnlocked ? "Unlocked âœ…" : `Unlock at 10 Phonics â­ (you have ${p.phonicsStars||0})`;
  }

  // Reset buttons
  document.getElementById("resetPhonics").onclick = ()=>{
    const p = getProgress(); p.phonicsStars = 0; save(PROG_KEY, p);
    renderStars(); renderBadges();
  };
  document.getElementById("resetReading").onclick = ()=>{
    const p = getProgress(); p.readingStars = 0; save(PROG_KEY, p);
    renderStars(); renderBadges();
  };
  document.getElementById("resetMath").onclick = ()=>{
    const p = getProgress(); p.mathStars = 0; save(PROG_KEY, p);
    renderStars(); renderBadges();
  };

  // Logout
  document.getElementById("logoutBtn").onclick = ()=>{
    localStorage.removeItem(STUDENT_KEY);
    window.location.href = "student-login.html";
  };

  renderStars();
  renderMission();
  renderBadges();
</script>

</body>
</html>
