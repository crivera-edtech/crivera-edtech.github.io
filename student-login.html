<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Student Login | BloomELearning âœ¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>

<header>
  <div class="container">
    <div class="logo">BloomELearning âœ¨</div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>

        <li class="dropdown">
          <a class="dropdown-toggle" href="#" aria-expanded="false">Subjects</a>
          <div class="dropdown-menu">
            <a href="phonics.html">ğŸ”¤ Phonics</a>
            <a href="reading.html">ğŸ“– Reading</a>
            <a href="math.html">â• Math</a>
          </div>
        </li>

        <li class="dropdown">
          <a class="dropdown-toggle" href="#" aria-expanded="false">Resources</a>
          <div class="dropdown-menu">
            <a href="resources.html">ğŸ¥ Kids Resources</a>
            <a href="parent-resources.html">ğŸ§‘â€ğŸ« Parent Resources</a>
            <a href="standards.html">ğŸ“˜ Standards (Kâ€“2)</a>
          </div>
        </li>

        <li class="dropdown">
          <a class="dropdown-toggle" href="#" aria-expanded="false">Student</a>
          <div class="dropdown-menu">
            <a href="student-login.html">ğŸ§’ Student Login</a>
            <a href="progress.html">ğŸ“Š My Progress</a>
            <a href="sticker-book.html">ğŸ“– Sticker Book</a>
          </div>
        </li>
      </ul>
    </nav>
  </div>
</header>

<section class="hero">
  <div class="container">
    <h1>Student Login ğŸ§’</h1>
    <p>Pick a buddy and type your name. This is a friendly â€œpretend loginâ€ for young learners.</p>
    <div class="quick-strip">
      <a class="btn secondary" href="progress.html">My Progress</a>
      <a class="btn secondary" href="sticker-book.html">Sticker Book</a>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">

    <div class="game-box wide">
      <div class="kid-big" style="text-align:center;">Welcome! ğŸŒŸ</div>
      <p class="small" style="text-align:center; margin-top:6px;">
        Your name and buddy save on this device so you can track stars and progress.
      </p>

      <!-- Grade (optional, helps diagnostics) -->
      <div class="game-box" style="margin-top:14px;">
        <div class="kid-big" style="margin-bottom:8px;">Choose Grade</div>
        <div class="badge-row" style="justify-content:center;">
          <button class="pill pill-lg active" data-grade="K">Kindergarten</button>
          <button class="pill pill-lg" data-grade="1">Grade 1</button>
          <button class="pill pill-lg" data-grade="2">Grade 2</button>
        </div>
        <p class="small" style="text-align:center; margin-top:8px;">
          (This helps pick the right diagnostic questions.)
        </p>
      </div>

      <!-- Buddy choose -->
      <div class="game-box" style="margin-top:14px;">
        <div class="kid-big" style="margin-bottom:10px;">Pick Your Buddy ğŸ¾</div>

        <div class="grid-3" id="buddyGrid">
          <div class="card buddy-card" role="button" tabindex="0" data-buddy="ğŸ°" data-name="Bunny">
            <h3 style="font-size:34px; margin-bottom:6px;">ğŸ°</h3>
            <p class="small"><strong>Bunny</strong></p>
          </div>

          <div class="card buddy-card" role="button" tabindex="0" data-buddy="ğŸ¦Š" data-name="Foxy">
            <h3 style="font-size:34px; margin-bottom:6px;">ğŸ¦Š</h3>
            <p class="small"><strong>Foxy</strong></p>
          </div>

          <div class="card buddy-card" role="button" tabindex="0" data-buddy="ğŸ¦„" data-name="Unicorn">
            <h3 style="font-size:34px; margin-bottom:6px;">ğŸ¦„</h3>
            <p class="small"><strong>Unicorn</strong></p>
          </div>

          <div class="card buddy-card" role="button" tabindex="0" data-buddy="ğŸ¼" data-name="Panda">
            <h3 style="font-size:34px; margin-bottom:6px;">ğŸ¼</h3>
            <p class="small"><strong>Panda</strong></p>
          </div>

          <div class="card buddy-card" role="button" tabindex="0" data-buddy="ğŸ¦‰" data-name="Owl">
            <h3 style="font-size:34px; margin-bottom:6px;">ğŸ¦‰</h3>
            <p class="small"><strong>Owl</strong></p>
          </div>

          <div class="card buddy-card" role="button" tabindex="0" data-buddy="ğŸ¦–" data-name="Dino">
            <h3 style="font-size:34px; margin-bottom:6px;">ğŸ¦–</h3>
            <p class="small"><strong>Dino</strong></p>
          </div>
        </div>

        <div class="kid-big" id="buddyStatus" style="margin-top:12px; text-align:center;">Selected: ğŸ¦„ Unicorn</div>
      </div>

      <!-- Name + actions -->
      <div class="game-box" style="margin-top:14px;">
        <div class="kid-big" style="margin-bottom:8px;">Your Name</div>

        <input
          id="nameInput"
          type="text"
          autocomplete="nickname"
          placeholder="Type name (or nickname)"
          style="width:100%; padding:14px 16px; border-radius:999px; border:2px solid rgba(0,0,0,0.12); font-size:18px; font-family:inherit;"
        />

        <div class="quick-strip" style="justify-content:flex-start; margin-top:12px;">
          <button class="btn" id="loginBtn">Log In</button>
          <button class="btn secondary" id="logoutBtn" style="display:none;">Log Out</button>
          <a class="btn secondary" id="goProgressBtn" href="progress.html" style="display:none;">Go to Progress</a>
        </div>

        <div class="kid-big" id="status" style="margin-top:12px;"></div>

        <div class="quick-strip" id="afterLoginLinks" style="display:none; justify-content:flex-start; margin-top:10px;">
          <a class="btn secondary" href="phonics.html">Start Phonics</a>
          <a class="btn secondary" href="reading.html">Start Reading</a>
          <a class="btn secondary" href="math.html">Start Math</a>
        </div>

        <p class="small" style="margin-top:10px;">
          Grown-up note: this is not secure â€” itâ€™s just a fun way to personalize learning on this device.
        </p>
      </div>

    </div>
  </div>
</section>

<footer>Â© 2026 BloomELearning âœ¨ | Made with ğŸ’š</footer>

<script src="./nav.js"></script>
<script>
  const STUDENT_KEY = "bloom_student";
  const PROG_KEY = "bloom_progress";
  const GRADE_KEY = "bloom_grade";

  function load(key, fallback){
    try { return JSON.parse(localStorage.getItem(key) || JSON.stringify(fallback)); }
    catch { return fallback; }
  }
  function save(key, val){ localStorage.setItem(key, JSON.stringify(val)); }

  // Grade
  let grade = (localStorage.getItem(GRADE_KEY) || "K").replaceAll('"','');
  const gradeBtns = document.querySelectorAll("[data-grade]");
  function renderGrade(){
    gradeBtns.forEach(b => b.classList.toggle("active", b.dataset.grade === grade));
    localStorage.setItem(GRADE_KEY, grade);
  }
  gradeBtns.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      grade = btn.dataset.grade;
      renderGrade();
    });
  });
  renderGrade();

  // Buddy
  let buddy = "ğŸ¦„";
  let buddyName = "Unicorn";

  const buddyCards = document.querySelectorAll(".buddy-card");
  const buddyStatus = document.getElementById("buddyStatus");

  function setBuddy(b, name){
    buddy = b;
    buddyName = name;
    buddyCards.forEach(c => c.style.outline = "none");
    const active = Array.from(buddyCards).find(x => x.dataset.buddy === buddy);
    if (active) active.style.outline = "4px solid rgba(255,225,184,.9)";
    buddyStatus.textContent = `Selected: ${buddy} ${buddyName}`;
  }

  buddyCards.forEach(card=>{
    const pick = () => setBuddy(card.dataset.buddy, card.dataset.name);
    card.addEventListener("click", pick);
    card.addEventListener("keydown", (e)=>{ if(e.key==="Enter" || e.key===" ") pick(); });
  });

  // Load existing student
  const statusEl = document.getElementById("status");
  const nameInput = document.getElementById("nameInput");
  const loginBtn = document.getElementById("loginBtn");
  const logoutBtn = document.getElementById("logoutBtn");
  const goProgressBtn = document.getElementById("goProgressBtn");
  const afterLoginLinks = document.getElementById("afterLoginLinks");

  function showLoggedInUI(student){
    loginBtn.textContent = "Update";
    logoutBtn.style.display = "inline-flex";
    goProgressBtn.style.display = "inline-flex";
    afterLoginLinks.style.display = "flex";
    statusEl.textContent = `Welcome back, ${student.buddy} ${student.name}! ğŸ‰`;
  }

  function showLoggedOutUI(){
    loginBtn.textContent = "Log In";
    logoutBtn.style.display = "none";
    goProgressBtn.style.display = "none";
    afterLoginLinks.style.display = "none";
    statusEl.textContent = "Type your name, then tap Log In ğŸ™‚";
  }

  const existing = load(STUDENT_KEY, null);
  if (existing && existing.name){
    nameInput.value = existing.name;
    setBuddy(existing.buddy || "ğŸ¦„", existing.buddyName || "Unicorn");
    showLoggedInUI(existing);
  } else {
    setBuddy("ğŸ¦„", "Unicorn");
    showLoggedOutUI();
  }

  // Ensure progress object exists (so progress page always has something to read)
  const prog = load(PROG_KEY, { phonicsStars:0, readingStars:0, mathStars:0 });
  save(PROG_KEY, prog);

  // Login / Update
  loginBtn.addEventListener("click", ()=>{
    const name = (nameInput.value || "").trim();
    if (!name){
      statusEl.textContent = "Please type your name ğŸ™‚";
      return;
    }

    const prev = load(STUDENT_KEY, null);
    const loginCount = (prev && typeof prev.loginCount === "number") ? prev.loginCount + 1 : 1;

    const student = {
      name,
      buddy,
      buddyName,
      grade,
      loginAt: Date.now(),
      loginCount,
      loggedIn: true
    };

    save(STUDENT_KEY, student);
    showLoggedInUI(student);
  });

  // Logout
  logoutBtn.addEventListener("click", ()=>{
    const prev = load(STUDENT_KEY, null);
    // keep a tiny bit of â€œlast usedâ€ so itâ€™s friendly next time (but logged out)
    const keep = prev ? { ...prev, loggedIn:false } : null;
    save(STUDENT_KEY, keep);
    showLoggedOutUI();
  });
</script>

</body>
</html>
